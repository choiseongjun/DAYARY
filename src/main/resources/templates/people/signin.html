<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"    
		xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<meta charset="UTF-8">
<meta name="google-signin-scope" content="profile email">
<meta name="google-signin-client_id"
	content="	681877465979-hbu3jluica1eddcndkvl52n6h10jq6sf.apps.googleusercontent.com">
<title>Insert title here</title>
<css th:replace="layout/header::headerCss" />

</head>

<body>
	<div th:replace="layout/header::header" />
	<p th:if="${loginError}" class="error">잘못된 아이디 또는 비밀번호입니다</p>
	<form th:action="@{/appLogin}" method="POST">
	<div class="login_popup">
			<p class="popup_main_text"><span>프룻</span>에 오신 것을 환영합니다!</p>
	        <p class="popup_sub_text">
	        	<span>프룻</span>은 ~이러한 <br>
	플랫폼 서비스입니다.
	        </p>
	        <div class="btn_box">
	        	<a href="#"><img src="/publ/images/layout/google.png" alt="Fruit 로고">Google</a>
	            <a href="#"><img src="/publ/images/layout/facebook.png" alt="Fruit 로고">Facebook</a>
	        </div>
	        <ul class="input_login_box">
	        	<li><input type="text" name="email" id="email" placeholder="이메일"></li>
	            <li><input type="password" name="password" id="password" placeholder="비밀번호"></li>
	        </ul>
	        <input type="submit" class="login_btn" value="로그인"/>
	        <div class="footer_login_btn">
	        	<a href="#" class="join_btn">회원가입</a>
	            <a href="#" class="find_login">비밀번호를 잊으셨다면</a>
	        </div>
	</div>
	</form>
	<div class="find_login_popup">
			<p class="popup_main_text"><span>프룻</span>회원가입</p>
	        <p class="popup_sub_text">
	        	Fruit은 ~이러한<br>
	플랫폼 서비스입니다.
	        </p>
	        <div class="btn_box">
	        	<a href="#"><img src="/publ/images/layout/google.png" alt="Fruit 로고">Google</a>
	            <a href="#"><img src="/publ/images/layout/facebook.png" alt="Fruit 로고">Facebook</a>
	        </div>
	        <ul class="input_login_box">
	        	<li><input type="text" placeholder="이메일"></li>
	            <li><input type="password" placeholder="비밀번호"></li>
	            <li><input type="password" placeholder="비밀번호 확인"></li>
	        </ul>
	        <div class="join_chk_box">
	        		<input type="checkbox" id="join_chk" class="cb2"><label for="join_chk"></label>
	                <p><span>프룻</span> 이용약관 및 <span>개인정보취급방침</span>에 동의합니다.</p>
	        </div>
	        <a href="#" class="login_btn finish_join">회원가입</a>
	        <div class="footer_login_btn">
	        	<a href="#" class="back_loing finish_join">로그인화면으로 가기</a>
	        </div>
	</div>
	
	
	<div class="my_type_popup">
			<p class="popup_main_text"><span>당신을 알려주세요</span></p>
	        <p class="popup_sub_text">
	        	‘닉네임’의 관심사에 맞게 <br>
	프룻이 추천해드릴게요!
	        </p>
	        <ul class="my_type_cho_ul">
	        	<li>
	            	<p>성별</p>
	                 <select id="type1" name="type1" class="select_pp" >
	                     <option value="0">남자</option>
	                     <option value="0">남자</option>
	                     <option value="1">여자</option>
	                  </select>
	            </li>
	            <li>
	            	<p>직업</p>
	                 <select id="type2" name="type2" class="select_pp" >
	                     <option value="0">직업1</option>
	                     <option value="0">직업1</option>
	                     <option value="1">직업3</option>
	                  </select>
	            </li>
	            <li>
	            	<p>관심사</p>
	                 <select id="type3" name="type3" class="select_pp" >
	                     <option value="0">관심사1</option>
	                     <option value="0">관심사1</option>
	                     <option value="1">관심사2</option>
	                  </select>
	            </li>
	        </ul>
	        <a href="#" class="login_btn join_go_btn">완료!</a>
	
	</div>
            User Name : <input type="text" name="email"/> <br/><br/>
            Password: <input type="password" name="password"/> <br/><br/>
            <input type="submit" value="Login"/>
           <div id="find">
        	해당 이메일로 임시비밀번호를 보내드립니다.<br/>
        	 	 아이디 : <input type="text" id="emailFind"/> <br/>
      	  </div>
            <button id="findButton">비밀번호 찾기</button>
      	
     
	<input type="hidden" id="authMessage" th:value="${authMessage}">
<!-- 	<script src="/js/people/signin.js"></script> -->
	<script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
	<script src="https://apis.google.com/js/platform.js" async defer></script>
	<script type="text/javascript"
		src="https://static.nid.naver.com/js/naverLogin_implicit-1.0.3.js"
		charset="utf-8"></script>
	
	<script>
	$(document).ready(function(){
		$(".login_popup").show()
		if($("#authMessage").val()){
			alert($("#authMessage").val());	
			}
			$("#find").toggle();
		});
	$("#findButton").click(function(){
		
		if($("#find").attr("style")=="display: none;")
			$("#find").toggle();
		else{
			 $.ajax({
			      url:'/auth/findPassword/'+$("#emailFind").val(),		
			      processData: false, //데이터를 쿼리 문자열로 변환하는 jQuery 형식 방지
			      contentType: "application/json; charset=utf-8",
			        processData: false, //데이터를 쿼리 문자열로 변환하는 jQuery 형식 방지
			        success:function(data){
			        	if(data.code=='1'){
			        		alert(data.message);
			        		$("#find").toggle();
			        		
			        	}
			        }
			        	
			        });
			
		}
		  
	});
	$(".open_login_popup").click(function(){
		$(".login_popup").show()
		
		})
	$(".join_go_btn").click(function(){
			$(".my_type_popup").hide()
			$(".find_login_popup").show()
		
		})	
	$(".join_btn").click(function(){
			$(".login_popup").hide()
			$(".my_type_popup").show()
		
		})
	$(".finish_join").click(function(){
			$(".find_login_popup").hide()
		
		})
		/* 구글 */
		function onSignIn(googleUser) {
			// Useful data for your client-side scripts:
			var profile = googleUser.getBasicProfile();
			console.log("ID: " + profile.getId()); // Don't send this directly to your server!
			console.log('Full Name: ' + profile.getName());
			console.log('Given Name: ' + profile.getGivenName());
			console.log('Family Name: ' + profile.getFamilyName());
			console.log("Image URL: " + profile.getImageUrl());
			console.log("Email: " + profile.getEmail());

			// The ID token you need to pass to your backend:
			var id_token = googleUser.getAuthResponse().id_token;
			console.log("ID Token: " + id_token);
		}

		/* 카카오 */
		// 사용할 앱의 JavaScript 키를 설정해 주세요.
		Kakao.init('8eb21286f0a69d0886357dbf7994d836');
		// 카카오 로그인 버튼을 생성합니다.
		Kakao.Auth.createLoginButton({
			container : '#kakao-login-btn',
			success : function(authObj) {
				Kakao.API.request({

					url : '/v1/user/me',

					success : function(res) {
						//로그인 성공 알림창 띄우고 메인화면으로 parameter 가지고 넘어가고 db에 id 저장

						alert(JSON.stringify(res)); //<---- kakao.api.request 에서 불러온 결과값 json형태로 출력

						alert(JSON.stringify(authObj)); //<----Kakao.Auth.createLoginButton에서 불러온 결과값 json형태로 출력

						console.log(res.id);//<---- 콘솔 로그에 id 정보 출력(id는 res안에 있기 때문에  res.id 로 불러온다)

						console.log(res.kaccount_email);//<---- 콘솔 로그에 email 정보 출력 (어딨는지 알겠죠?)

						console.log(res.properties['nickname']);//<---- 콘솔 로그에 닉네임 출력(properties에 있는 nickname 접근 

						// res.properties.nickname으로도 접근 가능 )

						console.log(authObj.access_token);//<---- 콘솔 로그에 토큰값 출력

					}
				})

				alert(JSON.stringify(authObj));
			},
			fail : function(err) {
				alert(JSON.stringify(err));
			}
		});
		//소셜 로그인
		$('.btn_social').click(function() {
			var socialType = $(this).data('social');
			location.href = "/oauth2/authorization/" + socialType;
		});
	</script>
</body>
</html>